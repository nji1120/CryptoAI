# TransformerAgentV3.1

## 概要
Predictorモデルをv3から変更  

### 変更目的
- agentで扱いやすくするため  
  v3.0のモデルは, 系列をずらすことで予測する未来の時刻もずらしていた.  
  ただ, これだと, Agentモデルと入力が異なることになり, 実装上非常に扱いにくい.
  そこで, 過去の情報は固定し, 予測する時刻を条件として与えることで, 予測する未来の時刻を設定できるように変更した.

### 変更詳細
- Predictorへの入力  
  入力は$s_{past}$の長さの時系列データをTransformerに入力する.  
  得られたCLSトークンの特徴量に対して, 予測する時刻をone-hotとしてconcatする.  
  その後, NNに入力して$\mu$と$\rm{log}\sigma^2$を出力する.  

### 期待される効果
- 予測時刻を柔軟に設定可能.  
- モデルを時間の関数にすることで, 大局が見れるモデルになる(かもしれない).  
  v3.0のモデルは, 点で予測するモデルであった.  